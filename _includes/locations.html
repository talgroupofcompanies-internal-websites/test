<!-- _includes/locations.html -->

<style>
  /* Locations Section */
  #locations {
    padding: 4rem 0;
  }
  #locations h2 {
    text-align: center;
    margin-bottom: 2rem;
    color: var(--primary);
  }

  /* Map container */
  #locations-map {
    width: 100%;
    height: 400px;
    border-radius: var(--border-radius);
    margin-bottom: 2rem;
  }

  /* Default list: flex wrap, centered rows */
  #locations .areas {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1rem;
    margin: 0 auto;
    padding: 0;
    list-style: none;
    max-width: 800px;
  }
  #locations .areas li {
    text-align: center;
    margin-bottom: 0.75rem;
  }
  #locations .areas li i {
    color: var(--accent);
    margin-right: 0.5rem;
  }

  /* Special case: exactly 5 items → 5-column grid, offset last two */
  #locations .areas.special-5 {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 1rem;
    margin: 0 auto;
    padding: 0;
    list-style: none;
    max-width: 800px;
  }
  #locations .areas.special-5 li {
    /* reset flex rules */
    margin-bottom: 0;
  }
  /* First 3 items will auto-place in row 1 cols 1–3 */
  /* Item 4 → row 2, col 2 */
  #locations .areas.special-5 li:nth-child(4) {
    grid-column: 2;
    grid-row: 2;
    text-align: center;
  }
  /* Item 5 → row 2, col 4 */
  #locations .areas.special-5 li:nth-child(5) {
    grid-column: 4;
    grid-row: 2;
    text-align: center;
  }
</style>

<!-- Leaflet CSS/JS (no API key needed) -->
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
/>
<script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>

<section id="locations">
  <div class="container">
    <h2>Service Areas</h2>
    <div id="locations-map"></div>
  </div>

  <div class="container">
    {% assign n = site.locations | size %}
    {% comment %}Choose UL class based on count{% endcomment %}
    {% if n == 5 %}
      <ul class="areas special-5">
    {% else %}
      <ul class="areas">
    {% endif %}
        {% for loc in site.locations %}
          <li>
            <i class="fas fa-map-marker-alt"></i>{{ loc.name }}
          </li>
        {% endfor %}
      </ul>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const coords = [
      {% for loc in site.locations %}
        [{{ loc.coordinates }}]{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ];

    const map = L.map("locations-map").setView(coords[0], 11);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "&copy; OpenStreetMap contributors"
    }).addTo(map);

    coords.forEach(c => L.marker(c).addTo(map));
  });
</script>
